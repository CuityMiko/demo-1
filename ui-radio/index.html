<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>美化单选</title>

    <style type="text/css">
        html,body,ul,li,input{
            padding:0;margin:0;
        }

        dt{
            padding-top:30px;
        }



        /*ui*/
        .ui-radio{
            display:inline-block;
            cursor:pointer;
        }
        .ui-radio span{
            padding-left:20px;
            background:url('img/icon.png') 0 0 no-repeat;
        }
        .ui-radio:hover span{
            background-position:0 -20px;
        }
        .ui-radio input:checked + span{
            background-position:0 -40px;
        }
        .ui-radio.checked span{
            background-position:0 -40px;
        }
        .ui-radio input{
            position:absolute;
            left:-9999em;
        }
    </style>
</head>
<body>

    <h1>美化单选</h1>
    
    <dl>
        <dt>
            demo
        </dt>
        <dd>
            <ul>
                <li>
                    <label class="ui-radio">
                        <input type="radio" name="xieliang" value="谢亮1">
                        <span>
                            谢亮1
                        </span>
                    </label>
                </li>
                <li>
                    <label class="ui-radio">
                        <input type="radio" name="xieliang" value="谢亮2">
                        <span>
                            谢亮2
                        </span>
                    </label>
                </li>
                <li>
                    <button>获取值</button>
                </li>
                <li>
                    <input type="button" id="test1" value="1,2来切换">
                </li>
            </ul>
        </dd>

        <dt>
            默认有选中
        </dt>
        <dd>
            <ul>
                <li>
                    <label class="ui-radio">
                        <input type="radio" name="xxxx" checked value="123">
                        <span>
                            123
                        </span>
                    </label>
                </li>
                <li>
                    <label class="ui-radio">
                        <input type="radio" name="xxxx" value="456">
                        <span>
                            456
                        </span>
                    </label>
                </li>
                <li>
                    <button>获取值</button>
                </li>
            </ul>
        </dd>



        <dt>
            测试
        </dt>
        <dd>
            <ul>
                <li>
                    <label class="ui-radio">
                        <input type="radio" name="x" value="xxxx1212">
                        <span>
                            xxxx1212
                        </span>
                    </label>
                </li>
                <li>
                    <label class="ui-radio">
                        <input type="radio" name="x" value="xxxx21212">
                        <span>
                            xxxx21212
                        </span>
                    </label>
                </li>
                <li>
                    <button>获取值</button>
                </li>
            </ul>
        </dd>
    </dl>

    

    <script type="text/javascript" src="http://libs.useso.com/js/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript">

        (function(){
            //fix 在ie78里直接使用js的prop,attr等没有改变UI
            if(!window.addEventListener){
                $.each([
                    'attr',
                    'removeAttr',
                    'prop',
                    'removeProp'
                ], function(index, value){
                    var _val = $.fn[value];
                    $.fn[value] = function(){
                        _val.apply(this, [].slice.call(arguments));
                        return this.trigger('change');
                    }
                });
            }

            $.fn.radioMM = function(){
                var self = this;

                //如果支持:checked伪类
                if(window.addEventListener){
                    return self;
                }
                
                //这里不做判断了,因为可能有选择器数组出现,用的时候选择器必须写对
                //如果不是绑定的单选
                // if(!self.length || self[0].nodeName.toUpperCase() !== 'INPUT' || self[0].type !== 'radio'){
                //     return self;
                // }
                

                //延迟处理下,fix ie78默认值问题
                setTimeout(function(){
                    self.filter(':checked').trigger('change');
                });

                return self.on('change', function(){
                    self.parent().removeClass('checked');
                    this.parentNode.className += ' checked';
                });
            }
        }());


        //按name分组进行绑定
        $('input[name="xieliang"]').radioMM();
        $('input[name="xxxx"]').radioMM();
        $('input[name="x"]').radioMM();

    
        //点击获取        
        $('dl').on('click', 'button', function(){
            var $input = $(this).closest('ul').find('input[type="radio"]');

           alert($input.filter(':checked').val() || '空'); 
        });

        $('#test1').on('click', function(){
            var $input = $(this).closest('ul').find('input[type="radio"]');
            var flag = $input.get(0).checked;

            if(!flag){
                $input.eq(0).prop('checked', true);
                // $input.eq(1).prop('checked', false);
            } else {
                $input.eq(1).prop('checked', true);
            }
        });
    </script>
</body>
</html>